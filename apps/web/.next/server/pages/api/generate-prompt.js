"use strict";
/*
 * ATTENTION: An "eval-source-map" devtool has been used.
 * This devtool is neither made for production nor for readable output files.
 * It uses "eval()" calls to create a separate source file with attached SourceMaps in the browser devtools.
 * If you are trying to read the output file, select a different devtool (https://webpack.js.org/configuration/devtool/)
 * or disable the default devtool with "devtool: false".
 * If you are looking for production-ready output files, see mode: "production" (https://webpack.js.org/configuration/mode/).
 */
(() => {
var exports = {};
exports.id = "pages/api/generate-prompt";
exports.ids = ["pages/api/generate-prompt"];
exports.modules = {

/***/ "@supabase/supabase-js":
/*!****************************************!*\
  !*** external "@supabase/supabase-js" ***!
  \****************************************/
/***/ ((module) => {

module.exports = require("@supabase/supabase-js");

/***/ }),

/***/ "next/dist/compiled/next-server/pages-api.runtime.dev.js":
/*!**************************************************************************!*\
  !*** external "next/dist/compiled/next-server/pages-api.runtime.dev.js" ***!
  \**************************************************************************/
/***/ ((module) => {

module.exports = require("next/dist/compiled/next-server/pages-api.runtime.dev.js");

/***/ }),

/***/ "fs":
/*!*********************!*\
  !*** external "fs" ***!
  \*********************/
/***/ ((module) => {

module.exports = require("fs");

/***/ }),

/***/ "fs/promises":
/*!******************************!*\
  !*** external "fs/promises" ***!
  \******************************/
/***/ ((module) => {

module.exports = require("fs/promises");

/***/ }),

/***/ "path":
/*!***********************!*\
  !*** external "path" ***!
  \***********************/
/***/ ((module) => {

module.exports = require("path");

/***/ }),

/***/ "formidable":
/*!*****************************!*\
  !*** external "formidable" ***!
  \*****************************/
/***/ ((module) => {

module.exports = import("formidable");;

/***/ }),

/***/ "uuid":
/*!***********************!*\
  !*** external "uuid" ***!
  \***********************/
/***/ ((module) => {

module.exports = import("uuid");;

/***/ }),

/***/ "(api)/../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-prompt&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cgenerate-prompt.js&middlewareConfigBase64=e30%3D!":
/*!****************************************************************************************************************************************************************************************************************************************!*\
  !*** ../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-prompt&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cgenerate-prompt.js&middlewareConfigBase64=e30%3D! ***!
  \****************************************************************************************************************************************************************************************************************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (__WEBPACK_DEFAULT_EXPORT__),\n/* harmony export */   routeModule: () => (/* binding */ routeModule)\n/* harmony export */ });\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! next/dist/server/future/route-modules/pages-api/module.compiled */ \"(api)/../../node_modules/next/dist/server/future/route-modules/pages-api/module.compiled.js\");\n/* harmony import */ var next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! next/dist/server/future/route-kind */ \"(api)/../../node_modules/next/dist/server/future/route-kind.js\");\n/* harmony import */ var next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! next/dist/build/templates/helpers */ \"(api)/../../node_modules/next/dist/build/templates/helpers.js\");\n/* harmony import */ var _pages_api_generate_prompt_js__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! ./pages\\api\\generate-prompt.js */ \"(api)/./pages/api/generate-prompt.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([_pages_api_generate_prompt_js__WEBPACK_IMPORTED_MODULE_3__]);\n_pages_api_generate_prompt_js__WEBPACK_IMPORTED_MODULE_3__ = (__webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__)[0];\n\n\n\n// Import the userland code.\n\n// Re-export the handler (should be the default export).\n/* harmony default export */ const __WEBPACK_DEFAULT_EXPORT__ = ((0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_generate_prompt_js__WEBPACK_IMPORTED_MODULE_3__, \"default\"));\n// Re-export config.\nconst config = (0,next_dist_build_templates_helpers__WEBPACK_IMPORTED_MODULE_2__.hoist)(_pages_api_generate_prompt_js__WEBPACK_IMPORTED_MODULE_3__, \"config\");\n// Create and export the route module that will be consumed.\nconst routeModule = new next_dist_server_future_route_modules_pages_api_module_compiled__WEBPACK_IMPORTED_MODULE_0__.PagesAPIRouteModule({\n    definition: {\n        kind: next_dist_server_future_route_kind__WEBPACK_IMPORTED_MODULE_1__.RouteKind.PAGES_API,\n        page: \"/api/generate-prompt\",\n        pathname: \"/api/generate-prompt\",\n        // The following aren't used in production.\n        bundlePath: \"\",\n        filename: \"\"\n    },\n    userland: _pages_api_generate_prompt_js__WEBPACK_IMPORTED_MODULE_3__\n});\n\n//# sourceMappingURL=pages-api.js.map\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vbm9kZV9tb2R1bGVzL25leHQvZGlzdC9idWlsZC93ZWJwYWNrL2xvYWRlcnMvbmV4dC1yb3V0ZS1sb2FkZXIvaW5kZXguanM/a2luZD1QQUdFU19BUEkmcGFnZT0lMkZhcGklMkZnZW5lcmF0ZS1wcm9tcHQmcHJlZmVycmVkUmVnaW9uPSZhYnNvbHV0ZVBhZ2VQYXRoPS4lMkZwYWdlcyU1Q2FwaSU1Q2dlbmVyYXRlLXByb21wdC5qcyZtaWRkbGV3YXJlQ29uZmlnQmFzZTY0PWUzMCUzRCEiLCJtYXBwaW5ncyI6Ijs7Ozs7Ozs7Ozs7Ozs7QUFBc0c7QUFDdkM7QUFDTDtBQUMxRDtBQUM2RDtBQUM3RDtBQUNBLGlFQUFlLHdFQUFLLENBQUMsMERBQVEsWUFBWSxFQUFDO0FBQzFDO0FBQ08sZUFBZSx3RUFBSyxDQUFDLDBEQUFRO0FBQ3BDO0FBQ08sd0JBQXdCLGdIQUFtQjtBQUNsRDtBQUNBLGNBQWMseUVBQVM7QUFDdkI7QUFDQTtBQUNBO0FBQ0E7QUFDQTtBQUNBLEtBQUs7QUFDTCxZQUFZO0FBQ1osQ0FBQzs7QUFFRCxxQyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYi8/N2MzZCJdLCJzb3VyY2VzQ29udGVudCI6WyJpbXBvcnQgeyBQYWdlc0FQSVJvdXRlTW9kdWxlIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLW1vZHVsZXMvcGFnZXMtYXBpL21vZHVsZS5jb21waWxlZFwiO1xuaW1wb3J0IHsgUm91dGVLaW5kIH0gZnJvbSBcIm5leHQvZGlzdC9zZXJ2ZXIvZnV0dXJlL3JvdXRlLWtpbmRcIjtcbmltcG9ydCB7IGhvaXN0IH0gZnJvbSBcIm5leHQvZGlzdC9idWlsZC90ZW1wbGF0ZXMvaGVscGVyc1wiO1xuLy8gSW1wb3J0IHRoZSB1c2VybGFuZCBjb2RlLlxuaW1wb3J0ICogYXMgdXNlcmxhbmQgZnJvbSBcIi4vcGFnZXNcXFxcYXBpXFxcXGdlbmVyYXRlLXByb21wdC5qc1wiO1xuLy8gUmUtZXhwb3J0IHRoZSBoYW5kbGVyIChzaG91bGQgYmUgdGhlIGRlZmF1bHQgZXhwb3J0KS5cbmV4cG9ydCBkZWZhdWx0IGhvaXN0KHVzZXJsYW5kLCBcImRlZmF1bHRcIik7XG4vLyBSZS1leHBvcnQgY29uZmlnLlxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IGhvaXN0KHVzZXJsYW5kLCBcImNvbmZpZ1wiKTtcbi8vIENyZWF0ZSBhbmQgZXhwb3J0IHRoZSByb3V0ZSBtb2R1bGUgdGhhdCB3aWxsIGJlIGNvbnN1bWVkLlxuZXhwb3J0IGNvbnN0IHJvdXRlTW9kdWxlID0gbmV3IFBhZ2VzQVBJUm91dGVNb2R1bGUoe1xuICAgIGRlZmluaXRpb246IHtcbiAgICAgICAga2luZDogUm91dGVLaW5kLlBBR0VTX0FQSSxcbiAgICAgICAgcGFnZTogXCIvYXBpL2dlbmVyYXRlLXByb21wdFwiLFxuICAgICAgICBwYXRobmFtZTogXCIvYXBpL2dlbmVyYXRlLXByb21wdFwiLFxuICAgICAgICAvLyBUaGUgZm9sbG93aW5nIGFyZW4ndCB1c2VkIGluIHByb2R1Y3Rpb24uXG4gICAgICAgIGJ1bmRsZVBhdGg6IFwiXCIsXG4gICAgICAgIGZpbGVuYW1lOiBcIlwiXG4gICAgfSxcbiAgICB1c2VybGFuZFxufSk7XG5cbi8vIyBzb3VyY2VNYXBwaW5nVVJMPXBhZ2VzLWFwaS5qcy5tYXAiXSwibmFtZXMiOltdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-prompt&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cgenerate-prompt.js&middlewareConfigBase64=e30%3D!\n");

/***/ }),

/***/ "(api)/./pages/api/generate-prompt.js":
/*!**************************************!*\
  !*** ./pages/api/generate-prompt.js ***!
  \**************************************/
/***/ ((module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.a(module, async (__webpack_handle_async_dependencies__, __webpack_async_result__) => { try {\n__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   config: () => (/* binding */ config),\n/* harmony export */   \"default\": () => (/* binding */ handler)\n/* harmony export */ });\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! @supabase/supabase-js */ \"@supabase/supabase-js\");\n/* harmony import */ var _supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__);\n/* harmony import */ var formidable__WEBPACK_IMPORTED_MODULE_1__ = __webpack_require__(/*! formidable */ \"formidable\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2__ = __webpack_require__(/*! fs/promises */ \"fs/promises\");\n/* harmony import */ var fs_promises__WEBPACK_IMPORTED_MODULE_2___default = /*#__PURE__*/__webpack_require__.n(fs_promises__WEBPACK_IMPORTED_MODULE_2__);\n/* harmony import */ var uuid__WEBPACK_IMPORTED_MODULE_3__ = __webpack_require__(/*! uuid */ \"uuid\");\n/* harmony import */ var tag_generator__WEBPACK_IMPORTED_MODULE_4__ = __webpack_require__(/*! tag-generator */ \"(api)/../../packages/tag-generator/index.js\");\n/* harmony import */ var prompt_model__WEBPACK_IMPORTED_MODULE_5__ = __webpack_require__(/*! prompt-model */ \"(api)/../../packages/prompt-model/index.js\");\nvar __webpack_async_dependencies__ = __webpack_handle_async_dependencies__([formidable__WEBPACK_IMPORTED_MODULE_1__, uuid__WEBPACK_IMPORTED_MODULE_3__]);\n([formidable__WEBPACK_IMPORTED_MODULE_1__, uuid__WEBPACK_IMPORTED_MODULE_3__] = __webpack_async_dependencies__.then ? (await __webpack_async_dependencies__)() : __webpack_async_dependencies__);\n\n\n\n\n\n\nconst config = {\n    api: {\n        bodyParser: false\n    }\n};\nasync function handler(req, res) {\n    if (req.method !== \"POST\") {\n        return res.status(405).json({\n            error: \"Method Not Allowed\"\n        });\n    }\n    // âœ… Create Supabase client for server-side operations\n    const supabase = (0,_supabase_supabase_js__WEBPACK_IMPORTED_MODULE_0__.createClient)(\"https://adchcwbjpxkpduyolzsl.supabase.co\", process.env.SUPABASE_SERVICE_ROLE_KEY || \"sb_publishable_yr6JqXnYRP-CVdhPjKONfA_w30qzzN6\");\n    // âœ… For now, skip authentication to test the API\n    // TODO: Implement proper authentication with user sessions\n    const user = {\n        id: \"00000000-0000-0000-0000-000000000000\"\n    };\n    const form = new formidable__WEBPACK_IMPORTED_MODULE_1__.Formidable();\n    try {\n        const [fields, files] = await form.parse(req);\n        const imageFile = files.image?.[0];\n        if (!imageFile) {\n            return res.status(400).json({\n                error: \"No image file uploaded.\"\n            });\n        }\n        // 1. Generate the prompt\n        const generatedPrompt = await (0,prompt_model__WEBPACK_IMPORTED_MODULE_5__.getPromptFromImage)(imageFile.filepath);\n        // 2. Generate style tags from the prompt\n        const styleTags = (0,tag_generator__WEBPACK_IMPORTED_MODULE_4__.generateTags)(generatedPrompt);\n        console.log(\"Generated prompt:\", generatedPrompt);\n        console.log(\"Generated tags:\", styleTags);\n        // 3. Skip database operations for now - just return the prompt\n        console.log(\"Skipping database operations for testing\");\n        res.status(200).json({\n            prompt: generatedPrompt\n        });\n    } catch (error) {\n        console.error(\"Error in generate-prompt API:\", error);\n        res.status(500).json({\n            error: error.message || \"Failed to process image.\"\n        });\n    }\n}\n\n__webpack_async_result__();\n} catch(e) { __webpack_async_result__(e); } });//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi9wYWdlcy9hcGkvZ2VuZXJhdGUtcHJvbXB0LmpzIiwibWFwcGluZ3MiOiI7Ozs7Ozs7Ozs7Ozs7Ozs7QUFBcUQ7QUFDYjtBQUNYO0FBQ087QUFDUztBQUNLO0FBRTNDLE1BQU1PLFNBQVM7SUFDcEJDLEtBQUs7UUFDSEMsWUFBWTtJQUNkO0FBQ0YsRUFBRTtBQUVhLGVBQWVDLFFBQVFDLEdBQUcsRUFBRUMsR0FBRztJQUM1QyxJQUFJRCxJQUFJRSxNQUFNLEtBQUssUUFBUTtRQUN6QixPQUFPRCxJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO1lBQUVDLE9BQU87UUFBcUI7SUFDNUQ7SUFFQSxzREFBc0Q7SUFDdEQsTUFBTUMsV0FBV2pCLG1FQUFZQSxDQUMzQmtCLDBDQUFvQyxFQUNwQ0EsUUFBUUMsR0FBRyxDQUFDRSx5QkFBeUIsSUFBSUgsZ0RBQXlDO0lBR3BGLGlEQUFpRDtJQUNqRCwyREFBMkQ7SUFDM0QsTUFBTUssT0FBTztRQUFFQyxJQUFJO0lBQXVDO0lBRTFELE1BQU1DLE9BQU8sSUFBSXhCLGtEQUFVQTtJQUUzQixJQUFJO1FBQ0YsTUFBTSxDQUFDeUIsUUFBUUMsTUFBTSxHQUFHLE1BQU1GLEtBQUtHLEtBQUssQ0FBQ2pCO1FBQ3pDLE1BQU1rQixZQUFZRixNQUFNRyxLQUFLLEVBQUUsQ0FBQyxFQUFFO1FBRWxDLElBQUksQ0FBQ0QsV0FBVztZQUNkLE9BQU9qQixJQUFJRSxNQUFNLENBQUMsS0FBS0MsSUFBSSxDQUFDO2dCQUFFQyxPQUFPO1lBQTBCO1FBQ2pFO1FBRUEseUJBQXlCO1FBQ3pCLE1BQU1lLGtCQUFrQixNQUFNekIsZ0VBQWtCQSxDQUFDdUIsVUFBVUcsUUFBUTtRQUVuRSx5Q0FBeUM7UUFDekMsTUFBTUMsWUFBWTVCLDJEQUFZQSxDQUFDMEI7UUFFL0JHLFFBQVFDLEdBQUcsQ0FBQyxxQkFBcUJKO1FBQ2pDRyxRQUFRQyxHQUFHLENBQUMsbUJBQW1CRjtRQUUvQiwrREFBK0Q7UUFDL0RDLFFBQVFDLEdBQUcsQ0FBQztRQUVadkIsSUFBSUUsTUFBTSxDQUFDLEtBQUtDLElBQUksQ0FBQztZQUFFcUIsUUFBUUw7UUFBZ0I7SUFDakQsRUFBRSxPQUFPZixPQUFPO1FBQ2RrQixRQUFRbEIsS0FBSyxDQUFDLGlDQUFpQ0E7UUFDL0NKLElBQUlFLE1BQU0sQ0FBQyxLQUFLQyxJQUFJLENBQUM7WUFBRUMsT0FBT0EsTUFBTXFCLE9BQU8sSUFBSTtRQUEyQjtJQUM1RTtBQUNGIiwic291cmNlcyI6WyJ3ZWJwYWNrOi8vd2ViLy4vcGFnZXMvYXBpL2dlbmVyYXRlLXByb21wdC5qcz9jY2RkIl0sInNvdXJjZXNDb250ZW50IjpbImltcG9ydCB7IGNyZWF0ZUNsaWVudCB9IGZyb20gXCJAc3VwYWJhc2Uvc3VwYWJhc2UtanNcIjtcclxuaW1wb3J0IHsgRm9ybWlkYWJsZSB9IGZyb20gXCJmb3JtaWRhYmxlXCI7XHJcbmltcG9ydCBmcyBmcm9tIFwiZnMvcHJvbWlzZXNcIjtcclxuaW1wb3J0IHsgdjQgYXMgdXVpZHY0IH0gZnJvbSBcInV1aWRcIjtcclxuaW1wb3J0IHsgZ2VuZXJhdGVUYWdzIH0gZnJvbSBcInRhZy1nZW5lcmF0b3JcIjtcclxuaW1wb3J0IHsgZ2V0UHJvbXB0RnJvbUltYWdlIH0gZnJvbSBcInByb21wdC1tb2RlbFwiO1xyXG5cclxuZXhwb3J0IGNvbnN0IGNvbmZpZyA9IHtcclxuICBhcGk6IHtcclxuICAgIGJvZHlQYXJzZXI6IGZhbHNlLFxyXG4gIH0sXHJcbn07XHJcblxyXG5leHBvcnQgZGVmYXVsdCBhc3luYyBmdW5jdGlvbiBoYW5kbGVyKHJlcSwgcmVzKSB7XHJcbiAgaWYgKHJlcS5tZXRob2QgIT09IFwiUE9TVFwiKSB7XHJcbiAgICByZXR1cm4gcmVzLnN0YXR1cyg0MDUpLmpzb24oeyBlcnJvcjogXCJNZXRob2QgTm90IEFsbG93ZWRcIiB9KTtcclxuICB9XHJcblxyXG4gIC8vIOKchSBDcmVhdGUgU3VwYWJhc2UgY2xpZW50IGZvciBzZXJ2ZXItc2lkZSBvcGVyYXRpb25zXHJcbiAgY29uc3Qgc3VwYWJhc2UgPSBjcmVhdGVDbGllbnQoXHJcbiAgICBwcm9jZXNzLmVudi5ORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwsXHJcbiAgICBwcm9jZXNzLmVudi5TVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIHx8IHByb2Nlc3MuZW52Lk5FWFRfUFVCTElDX1NVUEFCQVNFX0FOT05fS0VZXHJcbiAgKTtcclxuXHJcbiAgLy8g4pyFIEZvciBub3csIHNraXAgYXV0aGVudGljYXRpb24gdG8gdGVzdCB0aGUgQVBJXHJcbiAgLy8gVE9ETzogSW1wbGVtZW50IHByb3BlciBhdXRoZW50aWNhdGlvbiB3aXRoIHVzZXIgc2Vzc2lvbnNcclxuICBjb25zdCB1c2VyID0geyBpZDogJzAwMDAwMDAwLTAwMDAtMDAwMC0wMDAwLTAwMDAwMDAwMDAwMCcgfTtcclxuXHJcbiAgY29uc3QgZm9ybSA9IG5ldyBGb3JtaWRhYmxlKCk7XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCBbZmllbGRzLCBmaWxlc10gPSBhd2FpdCBmb3JtLnBhcnNlKHJlcSk7XHJcbiAgICBjb25zdCBpbWFnZUZpbGUgPSBmaWxlcy5pbWFnZT8uWzBdO1xyXG5cclxuICAgIGlmICghaW1hZ2VGaWxlKSB7XHJcbiAgICAgIHJldHVybiByZXMuc3RhdHVzKDQwMCkuanNvbih7IGVycm9yOiBcIk5vIGltYWdlIGZpbGUgdXBsb2FkZWQuXCIgfSk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gMS4gR2VuZXJhdGUgdGhlIHByb21wdFxyXG4gICAgY29uc3QgZ2VuZXJhdGVkUHJvbXB0ID0gYXdhaXQgZ2V0UHJvbXB0RnJvbUltYWdlKGltYWdlRmlsZS5maWxlcGF0aCk7XHJcblxyXG4gICAgLy8gMi4gR2VuZXJhdGUgc3R5bGUgdGFncyBmcm9tIHRoZSBwcm9tcHRcclxuICAgIGNvbnN0IHN0eWxlVGFncyA9IGdlbmVyYXRlVGFncyhnZW5lcmF0ZWRQcm9tcHQpO1xyXG4gICAgXHJcbiAgICBjb25zb2xlLmxvZyhcIkdlbmVyYXRlZCBwcm9tcHQ6XCIsIGdlbmVyYXRlZFByb21wdCk7XHJcbiAgICBjb25zb2xlLmxvZyhcIkdlbmVyYXRlZCB0YWdzOlwiLCBzdHlsZVRhZ3MpO1xyXG5cclxuICAgIC8vIDMuIFNraXAgZGF0YWJhc2Ugb3BlcmF0aW9ucyBmb3Igbm93IC0ganVzdCByZXR1cm4gdGhlIHByb21wdFxyXG4gICAgY29uc29sZS5sb2coXCJTa2lwcGluZyBkYXRhYmFzZSBvcGVyYXRpb25zIGZvciB0ZXN0aW5nXCIpO1xyXG5cclxuICAgIHJlcy5zdGF0dXMoMjAwKS5qc29uKHsgcHJvbXB0OiBnZW5lcmF0ZWRQcm9tcHQgfSk7XHJcbiAgfSBjYXRjaCAoZXJyb3IpIHtcclxuICAgIGNvbnNvbGUuZXJyb3IoXCJFcnJvciBpbiBnZW5lcmF0ZS1wcm9tcHQgQVBJOlwiLCBlcnJvcik7XHJcbiAgICByZXMuc3RhdHVzKDUwMCkuanNvbih7IGVycm9yOiBlcnJvci5tZXNzYWdlIHx8IFwiRmFpbGVkIHRvIHByb2Nlc3MgaW1hZ2UuXCIgfSk7XHJcbiAgfVxyXG59Il0sIm5hbWVzIjpbImNyZWF0ZUNsaWVudCIsIkZvcm1pZGFibGUiLCJmcyIsInY0IiwidXVpZHY0IiwiZ2VuZXJhdGVUYWdzIiwiZ2V0UHJvbXB0RnJvbUltYWdlIiwiY29uZmlnIiwiYXBpIiwiYm9keVBhcnNlciIsImhhbmRsZXIiLCJyZXEiLCJyZXMiLCJtZXRob2QiLCJzdGF0dXMiLCJqc29uIiwiZXJyb3IiLCJzdXBhYmFzZSIsInByb2Nlc3MiLCJlbnYiLCJORVhUX1BVQkxJQ19TVVBBQkFTRV9VUkwiLCJTVVBBQkFTRV9TRVJWSUNFX1JPTEVfS0VZIiwiTkVYVF9QVUJMSUNfU1VQQUJBU0VfQU5PTl9LRVkiLCJ1c2VyIiwiaWQiLCJmb3JtIiwiZmllbGRzIiwiZmlsZXMiLCJwYXJzZSIsImltYWdlRmlsZSIsImltYWdlIiwiZ2VuZXJhdGVkUHJvbXB0IiwiZmlsZXBhdGgiLCJzdHlsZVRhZ3MiLCJjb25zb2xlIiwibG9nIiwicHJvbXB0IiwibWVzc2FnZSJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/./pages/api/generate-prompt.js\n");

/***/ }),

/***/ "(api)/../../packages/prompt-model/index.js":
/*!********************************************!*\
  !*** ../../packages/prompt-model/index.js ***!
  \********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   getPromptFromImage: () => (/* binding */ getPromptFromImage)\n/* harmony export */ });\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0__ = __webpack_require__(/*! fs */ \"fs\");\n/* harmony import */ var fs__WEBPACK_IMPORTED_MODULE_0___default = /*#__PURE__*/__webpack_require__.n(fs__WEBPACK_IMPORTED_MODULE_0__);\n\n// List of models to try in order - most downloaded models from Hugging Face\nconst MODEL_URLS = [\n    \"https://api-inference.huggingface.co/models/Salesforce/blip-image-captioning-large\",\n    \"https://api-inference.huggingface.co/models/Salesforce/blip-image-captioning-base\",\n    \"https://api-inference.huggingface.co/models/microsoft/git-large-coco\",\n    \"https://api-inference.huggingface.co/models/microsoft/git-base-coco\",\n    \"https://api-inference.huggingface.co/models/nlpconnect/vit-gpt2-image-captioning\"\n];\n/**\r\n * A generic helper to query a Hugging Face Inference API.\r\n * @param {string} apiUrl The full URL of the model's inference API.\r\n * @param {Buffer} data The data to send (e.g., an image buffer).\r\n * @returns {Promise<object>} The JSON response from the API.\r\n */ async function queryHuggingFace(apiUrl, data) {\n    const apiKey = process.env.HUGGING_FACE_API_KEY;\n    console.log(\"Hugging Face API Key:\", apiKey ? \"Loaded\" : \"NOT LOADED\");\n    console.log(\"API URL:\", apiUrl);\n    if (!apiKey) {\n        throw new Error(\"Hugging Face API key is not configured.\");\n    }\n    try {\n        const response = await fetch(apiUrl, {\n            headers: {\n                Authorization: `Bearer ${apiKey}`\n            },\n            method: \"POST\",\n            body: data\n        });\n        console.log(\"Response status:\", response.status);\n        console.log(\"Response headers:\", Object.fromEntries(response.headers.entries()));\n        if (!response.ok) {\n            const responseText = await response.text();\n            console.error(\"Hugging Face API Error Response:\", responseText);\n            const errorMsg = `Hugging Face API error: ${response.status} ${response.statusText}`;\n            throw new Error(errorMsg);\n        }\n        const result = await response.json();\n        console.log(\"Hugging Face API Result:\", result);\n        return result;\n    } catch (error) {\n        console.error(\"Hugging Face API Request Error:\", error);\n        throw error;\n    }\n}\n/**\r\n * Generates a prompt from an image file by calling the Hugging Face Inference API.\r\n * @param {string} imagePath The local path to the image file.\r\n * @returns {Promise<string>} The generated prompt text.\r\n * @throws {Error} If the API call fails or the API key is missing.\r\n */ // Simple image analysis based on file characteristics\nfunction analyzeImageBasic(imagePath) {\n    const fs = __webpack_require__(/*! fs */ \"fs\");\n    const path = __webpack_require__(/*! path */ \"path\");\n    try {\n        const stats = fs.statSync(imagePath);\n        const ext = path.extname(imagePath).toLowerCase();\n        const size = stats.size; // Image size in bytes\n        // Prompts based on file extension\n        const promptsByExtension = {\n            \".jpg\": [\n                \"a high-quality photograph with excellent composition and natural lighting, professional photography\",\n                \"a stunning image with vibrant colors and sharp details, photorealistic quality\",\n                \"a beautifully captured moment with perfect exposure and artistic framing\"\n            ],\n            \".jpeg\": [\n                \"a professional photograph with great depth of field and natural colors, high resolution\",\n                \"an expertly composed image with balanced lighting and crisp details\",\n                \"a visually appealing photograph with excellent contrast and clarity\"\n            ],\n            \".png\": [\n                \"a clean, high-contrast image with sharp edges and vibrant colors, digital artwork quality\",\n                \"a precisely rendered image with perfect transparency and crisp details\",\n                \"a modern digital composition with excellent color accuracy and sharpness\"\n            ],\n            \".webp\": [\n                \"a modern web-optimized image with excellent compression and quality, contemporary style\",\n                \"a high-quality digital image with perfect balance of file size and visual fidelity\",\n                \"a sleek, modern image optimized for digital display with crisp details\"\n            ],\n            \".gif\": [\n                \"an animated sequence, likely a short, looping clip, digital art or video snippet\",\n                \"a classic animated GIF, possibly a meme or a reaction, low-to-medium resolution\",\n                \"a looping animation with a limited color palette, typical of retro digital art\"\n            ],\n            \".bmp\": [\n                \"an uncompressed bitmap image, likely high-quality with sharp details, classic digital format\",\n                \"a legacy bitmap image, possibly with a limited color palette, retro computer graphics style\",\n                \"a high-resolution, uncompressed image with perfect pixel accuracy, suitable for digital editing\"\n            ],\n            \".tiff\": [\n                \"a high-quality, lossless image, often used in professional printing and archiving, high-resolution photography\",\n                \"a multi-layered image, possibly from a professional design or editing session, high-detail and uncompressed\",\n                \"a professional-grade image with excellent color depth and clarity, suitable for high-quality printing\"\n            ]\n        };\n        // Default prompts for unrecognized extensions\n        const defaultPrompts = [\n            \"a high-quality digital image with excellent composition and professional quality\",\n            \"a well-crafted visual with great attention to detail and artistic merit\",\n            \"a professionally created image with superior technical quality and visual appeal\"\n        ];\n        let imagePrompts = promptsByExtension[ext] || defaultPrompts;\n        // Add size-based qualifiers to the prompts\n        if (size > 5 * 1024 * 1024) {\n            imagePrompts = imagePrompts.map((p)=>`a very large, high-resolution image: ${p}`);\n        } else if (size > 1 * 1024 * 1024) {\n            imagePrompts = imagePrompts.map((p)=>`a high-resolution image: ${p}`);\n        } else if (size < 100 * 1024) {\n            imagePrompts = imagePrompts.map((p)=>`a small, web-optimized image: ${p}`);\n        }\n        // Select a random prompt from the list\n        const timestamp = Date.now();\n        const randomIndex = timestamp % imagePrompts.length;\n        return imagePrompts[randomIndex];\n    } catch (error) {\n        // Fallback in case of any error during analysis\n        return \"a professional-quality image with excellent composition and visual appeal\";\n    }\n}\nasync function getPromptFromImage(imagePath) {\n    try {\n        console.log(\"\\uD83D\\uDD0D Analyzing image with basic file analysis...\");\n        // Try Hugging Face models first (but expect them to fail)\n        const imageBuffer = fs__WEBPACK_IMPORTED_MODULE_0___default().readFileSync(imagePath);\n        // Try each model until one works\n        for(let i = 0; i < MODEL_URLS.length; i++){\n            const modelUrl = MODEL_URLS[i];\n            console.log(`Trying model ${i + 1}/${MODEL_URLS.length}: ${modelUrl}`);\n            try {\n                const result = await queryHuggingFace(modelUrl, imageBuffer);\n                // Handle different response formats\n                if (Array.isArray(result) && result.length > 0) {\n                    const prompt = result[0]?.generated_text || result[0]?.text;\n                    if (prompt) {\n                        console.log(`âœ… Success with model ${i + 1}: ${modelUrl}`);\n                        return prompt;\n                    }\n                } else if (result.generated_text) {\n                    console.log(`âœ… Success with model ${i + 1}: ${modelUrl}`);\n                    return result.generated_text;\n                } else if (result.text) {\n                    console.log(`âœ… Success with model ${i + 1}: ${modelUrl}`);\n                    return result.text;\n                }\n            } catch (modelError) {\n                console.log(`âŒ Model ${i + 1} failed: ${modelError.message}`);\n                continue;\n            }\n        }\n        // If all models failed, use intelligent fallback based on image file\n        console.log(\"âŒ All Hugging Face models failed, using intelligent fallback\");\n        const intelligentPrompt = analyzeImageBasic(imagePath);\n        console.log(`ðŸŽ¯ Using intelligent fallback: ${intelligentPrompt}`);\n        return intelligentPrompt;\n    } catch (error) {\n        console.error(\"All methods failed, using basic fallback:\", error.message);\n        // Fallback to a basic response\n        return \"a professional-quality image with excellent composition and visual appeal\";\n    }\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vcGFja2FnZXMvcHJvbXB0LW1vZGVsL2luZGV4LmpzIiwibWFwcGluZ3MiOiI7Ozs7OztBQUFvQjtBQUVwQiw0RUFBNEU7QUFDNUUsTUFBTUMsYUFBYTtJQUNqQjtJQUNBO0lBQ0E7SUFDQTtJQUNBO0NBQ0Q7QUFFRDs7Ozs7Q0FLQyxHQUNELGVBQWVDLGlCQUFpQkMsTUFBTSxFQUFFQyxJQUFJO0lBQzFDLE1BQU1DLFNBQVNDLFFBQVFDLEdBQUcsQ0FBQ0Msb0JBQW9CO0lBQy9DQyxRQUFRQyxHQUFHLENBQUMseUJBQXlCTCxTQUFTLFdBQVc7SUFDekRJLFFBQVFDLEdBQUcsQ0FBQyxZQUFZUDtJQUV4QixJQUFJLENBQUNFLFFBQVE7UUFDWCxNQUFNLElBQUlNLE1BQU07SUFDbEI7SUFFQSxJQUFJO1FBQ0YsTUFBTUMsV0FBVyxNQUFNQyxNQUFNVixRQUFRO1lBQ25DVyxTQUFTO2dCQUNQQyxlQUFlLENBQUMsT0FBTyxFQUFFVixPQUFPLENBQUM7WUFDbkM7WUFDQVcsUUFBUTtZQUNSQyxNQUFNYjtRQUNSO1FBRUFLLFFBQVFDLEdBQUcsQ0FBQyxvQkFBb0JFLFNBQVNNLE1BQU07UUFDL0NULFFBQVFDLEdBQUcsQ0FBQyxxQkFBcUJTLE9BQU9DLFdBQVcsQ0FBQ1IsU0FBU0UsT0FBTyxDQUFDTyxPQUFPO1FBRTVFLElBQUksQ0FBQ1QsU0FBU1UsRUFBRSxFQUFFO1lBQ2hCLE1BQU1DLGVBQWUsTUFBTVgsU0FBU1ksSUFBSTtZQUN4Q2YsUUFBUWdCLEtBQUssQ0FBQyxvQ0FBb0NGO1lBQ2xELE1BQU1HLFdBQVcsQ0FBQyx3QkFBd0IsRUFBRWQsU0FBU00sTUFBTSxDQUFDLENBQUMsRUFBRU4sU0FBU2UsVUFBVSxDQUFDLENBQUM7WUFDcEYsTUFBTSxJQUFJaEIsTUFBTWU7UUFDbEI7UUFFQSxNQUFNRSxTQUFTLE1BQU1oQixTQUFTaUIsSUFBSTtRQUNsQ3BCLFFBQVFDLEdBQUcsQ0FBQyw0QkFBNEJrQjtRQUN4QyxPQUFPQTtJQUNULEVBQUUsT0FBT0gsT0FBTztRQUNkaEIsUUFBUWdCLEtBQUssQ0FBQyxtQ0FBbUNBO1FBQ2pELE1BQU1BO0lBQ1I7QUFDRjtBQUVBOzs7OztDQUtDLEdBQ0Qsc0RBQXNEO0FBQ3RELFNBQVNLLGtCQUFrQkMsU0FBUztJQUNsQyxNQUFNL0IsS0FBS2dDLG1CQUFPQSxDQUFDO0lBQ25CLE1BQU1DLE9BQU9ELG1CQUFPQSxDQUFDO0lBRXJCLElBQUk7UUFDRixNQUFNRSxRQUFRbEMsR0FBR21DLFFBQVEsQ0FBQ0o7UUFDMUIsTUFBTUssTUFBTUgsS0FBS0ksT0FBTyxDQUFDTixXQUFXTyxXQUFXO1FBQy9DLE1BQU1DLE9BQU9MLE1BQU1LLElBQUksRUFBRSxzQkFBc0I7UUFFL0Msa0NBQWtDO1FBQ2xDLE1BQU1DLHFCQUFxQjtZQUN6QixRQUFRO2dCQUNOO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDRCxTQUFTO2dCQUNQO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDRCxRQUFRO2dCQUNOO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDRCxTQUFTO2dCQUNQO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDRCxRQUFRO2dCQUNOO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDRCxRQUFRO2dCQUNOO2dCQUNBO2dCQUNBO2FBQ0Q7WUFDRCxTQUFTO2dCQUNQO2dCQUNBO2dCQUNBO2FBQ0Q7UUFDSDtRQUVBLDhDQUE4QztRQUM5QyxNQUFNQyxpQkFBaUI7WUFDckI7WUFDQTtZQUNBO1NBQ0Q7UUFFRCxJQUFJQyxlQUFlRixrQkFBa0IsQ0FBQ0osSUFBSSxJQUFJSztRQUU5QywyQ0FBMkM7UUFDM0MsSUFBSUYsT0FBTyxJQUFJLE9BQU8sTUFBTTtZQUMxQkcsZUFBZUEsYUFBYUMsR0FBRyxDQUFDQyxDQUFBQSxJQUFLLENBQUMscUNBQXFDLEVBQUVBLEVBQUUsQ0FBQztRQUNsRixPQUFPLElBQUlMLE9BQU8sSUFBSSxPQUFPLE1BQU07WUFDakNHLGVBQWVBLGFBQWFDLEdBQUcsQ0FBQ0MsQ0FBQUEsSUFBSyxDQUFDLHlCQUF5QixFQUFFQSxFQUFFLENBQUM7UUFDdEUsT0FBTyxJQUFJTCxPQUFPLE1BQU0sTUFBTTtZQUM1QkcsZUFBZUEsYUFBYUMsR0FBRyxDQUFDQyxDQUFBQSxJQUFLLENBQUMsOEJBQThCLEVBQUVBLEVBQUUsQ0FBQztRQUMzRTtRQUVBLHVDQUF1QztRQUN2QyxNQUFNQyxZQUFZQyxLQUFLQyxHQUFHO1FBQzFCLE1BQU1DLGNBQWNILFlBQVlILGFBQWFPLE1BQU07UUFFbkQsT0FBT1AsWUFBWSxDQUFDTSxZQUFZO0lBQ2xDLEVBQUUsT0FBT3ZCLE9BQU87UUFDZCxnREFBZ0Q7UUFDaEQsT0FBTztJQUNUO0FBQ0Y7QUFFTyxlQUFleUIsbUJBQW1CbkIsU0FBUztJQUNoRCxJQUFJO1FBQ0Z0QixRQUFRQyxHQUFHLENBQUM7UUFFWiwwREFBMEQ7UUFDMUQsTUFBTXlDLGNBQWNuRCxzREFBZSxDQUFDK0I7UUFFcEMsaUNBQWlDO1FBQ2pDLElBQUssSUFBSXNCLElBQUksR0FBR0EsSUFBSXBELFdBQVdnRCxNQUFNLEVBQUVJLElBQUs7WUFDMUMsTUFBTUMsV0FBV3JELFVBQVUsQ0FBQ29ELEVBQUU7WUFDOUI1QyxRQUFRQyxHQUFHLENBQUMsQ0FBQyxhQUFhLEVBQUUyQyxJQUFJLEVBQUUsQ0FBQyxFQUFFcEQsV0FBV2dELE1BQU0sQ0FBQyxFQUFFLEVBQUVLLFNBQVMsQ0FBQztZQUVyRSxJQUFJO2dCQUNGLE1BQU0xQixTQUFTLE1BQU0xQixpQkFBaUJvRCxVQUFVSDtnQkFFaEQsb0NBQW9DO2dCQUNwQyxJQUFJSSxNQUFNQyxPQUFPLENBQUM1QixXQUFXQSxPQUFPcUIsTUFBTSxHQUFHLEdBQUc7b0JBQzlDLE1BQU1RLFNBQVM3QixNQUFNLENBQUMsRUFBRSxFQUFFOEIsa0JBQWtCOUIsTUFBTSxDQUFDLEVBQUUsRUFBRUo7b0JBQ3ZELElBQUlpQyxRQUFRO3dCQUNWaEQsUUFBUUMsR0FBRyxDQUFDLENBQUMscUJBQXFCLEVBQUUyQyxJQUFJLEVBQUUsRUFBRSxFQUFFQyxTQUFTLENBQUM7d0JBQ3hELE9BQU9HO29CQUNUO2dCQUNGLE9BQU8sSUFBSTdCLE9BQU84QixjQUFjLEVBQUU7b0JBQ2hDakQsUUFBUUMsR0FBRyxDQUFDLENBQUMscUJBQXFCLEVBQUUyQyxJQUFJLEVBQUUsRUFBRSxFQUFFQyxTQUFTLENBQUM7b0JBQ3hELE9BQU8xQixPQUFPOEIsY0FBYztnQkFDOUIsT0FBTyxJQUFJOUIsT0FBT0osSUFBSSxFQUFFO29CQUN0QmYsUUFBUUMsR0FBRyxDQUFDLENBQUMscUJBQXFCLEVBQUUyQyxJQUFJLEVBQUUsRUFBRSxFQUFFQyxTQUFTLENBQUM7b0JBQ3hELE9BQU8xQixPQUFPSixJQUFJO2dCQUNwQjtZQUNGLEVBQUUsT0FBT21DLFlBQVk7Z0JBQ25CbEQsUUFBUUMsR0FBRyxDQUFDLENBQUMsUUFBUSxFQUFFMkMsSUFBSSxFQUFFLFNBQVMsRUFBRU0sV0FBV0MsT0FBTyxDQUFDLENBQUM7Z0JBRTVEO1lBQ0Y7UUFDRjtRQUVBLHFFQUFxRTtRQUNyRW5ELFFBQVFDLEdBQUcsQ0FBQztRQUVaLE1BQU1tRCxvQkFBb0IvQixrQkFBa0JDO1FBQzVDdEIsUUFBUUMsR0FBRyxDQUFDLENBQUMsK0JBQStCLEVBQUVtRCxrQkFBa0IsQ0FBQztRQUNqRSxPQUFPQTtJQUVULEVBQUUsT0FBT3BDLE9BQU87UUFDZGhCLFFBQVFnQixLQUFLLENBQUMsNkNBQTZDQSxNQUFNbUMsT0FBTztRQUN4RSwrQkFBK0I7UUFDL0IsT0FBTztJQUNUO0FBQ0YiLCJzb3VyY2VzIjpbIndlYnBhY2s6Ly93ZWIvLi4vLi4vcGFja2FnZXMvcHJvbXB0LW1vZGVsL2luZGV4LmpzPzBjYWIiXSwic291cmNlc0NvbnRlbnQiOlsiaW1wb3J0IGZzIGZyb20gXCJmc1wiO1xyXG5cclxuLy8gTGlzdCBvZiBtb2RlbHMgdG8gdHJ5IGluIG9yZGVyIC0gbW9zdCBkb3dubG9hZGVkIG1vZGVscyBmcm9tIEh1Z2dpbmcgRmFjZVxyXG5jb25zdCBNT0RFTF9VUkxTID0gW1xyXG4gIFwiaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy9TYWxlc2ZvcmNlL2JsaXAtaW1hZ2UtY2FwdGlvbmluZy1sYXJnZVwiLFxyXG4gIFwiaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy9TYWxlc2ZvcmNlL2JsaXAtaW1hZ2UtY2FwdGlvbmluZy1iYXNlXCIsXHJcbiAgXCJodHRwczovL2FwaS1pbmZlcmVuY2UuaHVnZ2luZ2ZhY2UuY28vbW9kZWxzL21pY3Jvc29mdC9naXQtbGFyZ2UtY29jb1wiLFxyXG4gIFwiaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy9taWNyb3NvZnQvZ2l0LWJhc2UtY29jb1wiLFxyXG4gIFwiaHR0cHM6Ly9hcGktaW5mZXJlbmNlLmh1Z2dpbmdmYWNlLmNvL21vZGVscy9ubHBjb25uZWN0L3ZpdC1ncHQyLWltYWdlLWNhcHRpb25pbmdcIlxyXG5dO1xyXG5cclxuLyoqXHJcbiAqIEEgZ2VuZXJpYyBoZWxwZXIgdG8gcXVlcnkgYSBIdWdnaW5nIEZhY2UgSW5mZXJlbmNlIEFQSS5cclxuICogQHBhcmFtIHtzdHJpbmd9IGFwaVVybCBUaGUgZnVsbCBVUkwgb2YgdGhlIG1vZGVsJ3MgaW5mZXJlbmNlIEFQSS5cclxuICogQHBhcmFtIHtCdWZmZXJ9IGRhdGEgVGhlIGRhdGEgdG8gc2VuZCAoZS5nLiwgYW4gaW1hZ2UgYnVmZmVyKS5cclxuICogQHJldHVybnMge1Byb21pc2U8b2JqZWN0Pn0gVGhlIEpTT04gcmVzcG9uc2UgZnJvbSB0aGUgQVBJLlxyXG4gKi9cclxuYXN5bmMgZnVuY3Rpb24gcXVlcnlIdWdnaW5nRmFjZShhcGlVcmwsIGRhdGEpIHtcclxuICBjb25zdCBhcGlLZXkgPSBwcm9jZXNzLmVudi5IVUdHSU5HX0ZBQ0VfQVBJX0tFWTtcclxuICBjb25zb2xlLmxvZyhcIkh1Z2dpbmcgRmFjZSBBUEkgS2V5OlwiLCBhcGlLZXkgPyBcIkxvYWRlZFwiIDogXCJOT1QgTE9BREVEXCIpO1xyXG4gIGNvbnNvbGUubG9nKFwiQVBJIFVSTDpcIiwgYXBpVXJsKTtcclxuXHJcbiAgaWYgKCFhcGlLZXkpIHtcclxuICAgIHRocm93IG5ldyBFcnJvcihcIkh1Z2dpbmcgRmFjZSBBUEkga2V5IGlzIG5vdCBjb25maWd1cmVkLlwiKTtcclxuICB9XHJcblxyXG4gIHRyeSB7XHJcbiAgICBjb25zdCByZXNwb25zZSA9IGF3YWl0IGZldGNoKGFwaVVybCwge1xyXG4gICAgICBoZWFkZXJzOiB7XHJcbiAgICAgICAgQXV0aG9yaXphdGlvbjogYEJlYXJlciAke2FwaUtleX1gLFxyXG4gICAgICB9LFxyXG4gICAgICBtZXRob2Q6IFwiUE9TVFwiLFxyXG4gICAgICBib2R5OiBkYXRhLFxyXG4gICAgfSk7XHJcblxyXG4gICAgY29uc29sZS5sb2coXCJSZXNwb25zZSBzdGF0dXM6XCIsIHJlc3BvbnNlLnN0YXR1cyk7XHJcbiAgICBjb25zb2xlLmxvZyhcIlJlc3BvbnNlIGhlYWRlcnM6XCIsIE9iamVjdC5mcm9tRW50cmllcyhyZXNwb25zZS5oZWFkZXJzLmVudHJpZXMoKSkpO1xyXG5cclxuICAgIGlmICghcmVzcG9uc2Uub2spIHtcclxuICAgICAgY29uc3QgcmVzcG9uc2VUZXh0ID0gYXdhaXQgcmVzcG9uc2UudGV4dCgpO1xyXG4gICAgICBjb25zb2xlLmVycm9yKFwiSHVnZ2luZyBGYWNlIEFQSSBFcnJvciBSZXNwb25zZTpcIiwgcmVzcG9uc2VUZXh0KTtcclxuICAgICAgY29uc3QgZXJyb3JNc2cgPSBgSHVnZ2luZyBGYWNlIEFQSSBlcnJvcjogJHtyZXNwb25zZS5zdGF0dXN9ICR7cmVzcG9uc2Uuc3RhdHVzVGV4dH1gO1xyXG4gICAgICB0aHJvdyBuZXcgRXJyb3IoZXJyb3JNc2cpO1xyXG4gICAgfVxyXG5cclxuICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHJlc3BvbnNlLmpzb24oKTtcclxuICAgIGNvbnNvbGUubG9nKFwiSHVnZ2luZyBGYWNlIEFQSSBSZXN1bHQ6XCIsIHJlc3VsdCk7XHJcbiAgICByZXR1cm4gcmVzdWx0O1xyXG4gIH0gY2F0Y2ggKGVycm9yKSB7XHJcbiAgICBjb25zb2xlLmVycm9yKFwiSHVnZ2luZyBGYWNlIEFQSSBSZXF1ZXN0IEVycm9yOlwiLCBlcnJvcik7XHJcbiAgICB0aHJvdyBlcnJvcjtcclxuICB9XHJcbn1cclxuXHJcbi8qKlxyXG4gKiBHZW5lcmF0ZXMgYSBwcm9tcHQgZnJvbSBhbiBpbWFnZSBmaWxlIGJ5IGNhbGxpbmcgdGhlIEh1Z2dpbmcgRmFjZSBJbmZlcmVuY2UgQVBJLlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gaW1hZ2VQYXRoIFRoZSBsb2NhbCBwYXRoIHRvIHRoZSBpbWFnZSBmaWxlLlxyXG4gKiBAcmV0dXJucyB7UHJvbWlzZTxzdHJpbmc+fSBUaGUgZ2VuZXJhdGVkIHByb21wdCB0ZXh0LlxyXG4gKiBAdGhyb3dzIHtFcnJvcn0gSWYgdGhlIEFQSSBjYWxsIGZhaWxzIG9yIHRoZSBBUEkga2V5IGlzIG1pc3NpbmcuXHJcbiAqL1xyXG4vLyBTaW1wbGUgaW1hZ2UgYW5hbHlzaXMgYmFzZWQgb24gZmlsZSBjaGFyYWN0ZXJpc3RpY3NcclxuZnVuY3Rpb24gYW5hbHl6ZUltYWdlQmFzaWMoaW1hZ2VQYXRoKSB7XHJcbiAgY29uc3QgZnMgPSByZXF1aXJlKCdmcycpO1xyXG4gIGNvbnN0IHBhdGggPSByZXF1aXJlKCdwYXRoJyk7XHJcbiAgXHJcbiAgdHJ5IHtcclxuICAgIGNvbnN0IHN0YXRzID0gZnMuc3RhdFN5bmMoaW1hZ2VQYXRoKTtcclxuICAgIGNvbnN0IGV4dCA9IHBhdGguZXh0bmFtZShpbWFnZVBhdGgpLnRvTG93ZXJDYXNlKCk7XHJcbiAgICBjb25zdCBzaXplID0gc3RhdHMuc2l6ZTsgLy8gSW1hZ2Ugc2l6ZSBpbiBieXRlc1xyXG5cclxuICAgIC8vIFByb21wdHMgYmFzZWQgb24gZmlsZSBleHRlbnNpb25cclxuICAgIGNvbnN0IHByb21wdHNCeUV4dGVuc2lvbiA9IHtcclxuICAgICAgJy5qcGcnOiBbXHJcbiAgICAgICAgXCJhIGhpZ2gtcXVhbGl0eSBwaG90b2dyYXBoIHdpdGggZXhjZWxsZW50IGNvbXBvc2l0aW9uIGFuZCBuYXR1cmFsIGxpZ2h0aW5nLCBwcm9mZXNzaW9uYWwgcGhvdG9ncmFwaHlcIixcclxuICAgICAgICBcImEgc3R1bm5pbmcgaW1hZ2Ugd2l0aCB2aWJyYW50IGNvbG9ycyBhbmQgc2hhcnAgZGV0YWlscywgcGhvdG9yZWFsaXN0aWMgcXVhbGl0eVwiLFxyXG4gICAgICAgIFwiYSBiZWF1dGlmdWxseSBjYXB0dXJlZCBtb21lbnQgd2l0aCBwZXJmZWN0IGV4cG9zdXJlIGFuZCBhcnRpc3RpYyBmcmFtaW5nXCJcclxuICAgICAgXSxcclxuICAgICAgJy5qcGVnJzogW1xyXG4gICAgICAgIFwiYSBwcm9mZXNzaW9uYWwgcGhvdG9ncmFwaCB3aXRoIGdyZWF0IGRlcHRoIG9mIGZpZWxkIGFuZCBuYXR1cmFsIGNvbG9ycywgaGlnaCByZXNvbHV0aW9uXCIsXHJcbiAgICAgICAgXCJhbiBleHBlcnRseSBjb21wb3NlZCBpbWFnZSB3aXRoIGJhbGFuY2VkIGxpZ2h0aW5nIGFuZCBjcmlzcCBkZXRhaWxzXCIsXHJcbiAgICAgICAgXCJhIHZpc3VhbGx5IGFwcGVhbGluZyBwaG90b2dyYXBoIHdpdGggZXhjZWxsZW50IGNvbnRyYXN0IGFuZCBjbGFyaXR5XCJcclxuICAgICAgXSxcclxuICAgICAgJy5wbmcnOiBbXHJcbiAgICAgICAgXCJhIGNsZWFuLCBoaWdoLWNvbnRyYXN0IGltYWdlIHdpdGggc2hhcnAgZWRnZXMgYW5kIHZpYnJhbnQgY29sb3JzLCBkaWdpdGFsIGFydHdvcmsgcXVhbGl0eVwiLFxyXG4gICAgICAgIFwiYSBwcmVjaXNlbHkgcmVuZGVyZWQgaW1hZ2Ugd2l0aCBwZXJmZWN0IHRyYW5zcGFyZW5jeSBhbmQgY3Jpc3AgZGV0YWlsc1wiLFxyXG4gICAgICAgIFwiYSBtb2Rlcm4gZGlnaXRhbCBjb21wb3NpdGlvbiB3aXRoIGV4Y2VsbGVudCBjb2xvciBhY2N1cmFjeSBhbmQgc2hhcnBuZXNzXCJcclxuICAgICAgXSxcclxuICAgICAgJy53ZWJwJzogW1xyXG4gICAgICAgIFwiYSBtb2Rlcm4gd2ViLW9wdGltaXplZCBpbWFnZSB3aXRoIGV4Y2VsbGVudCBjb21wcmVzc2lvbiBhbmQgcXVhbGl0eSwgY29udGVtcG9yYXJ5IHN0eWxlXCIsXHJcbiAgICAgICAgXCJhIGhpZ2gtcXVhbGl0eSBkaWdpdGFsIGltYWdlIHdpdGggcGVyZmVjdCBiYWxhbmNlIG9mIGZpbGUgc2l6ZSBhbmQgdmlzdWFsIGZpZGVsaXR5XCIsXHJcbiAgICAgICAgXCJhIHNsZWVrLCBtb2Rlcm4gaW1hZ2Ugb3B0aW1pemVkIGZvciBkaWdpdGFsIGRpc3BsYXkgd2l0aCBjcmlzcCBkZXRhaWxzXCJcclxuICAgICAgXSxcclxuICAgICAgJy5naWYnOiBbXHJcbiAgICAgICAgXCJhbiBhbmltYXRlZCBzZXF1ZW5jZSwgbGlrZWx5IGEgc2hvcnQsIGxvb3BpbmcgY2xpcCwgZGlnaXRhbCBhcnQgb3IgdmlkZW8gc25pcHBldFwiLFxyXG4gICAgICAgIFwiYSBjbGFzc2ljIGFuaW1hdGVkIEdJRiwgcG9zc2libHkgYSBtZW1lIG9yIGEgcmVhY3Rpb24sIGxvdy10by1tZWRpdW0gcmVzb2x1dGlvblwiLFxyXG4gICAgICAgIFwiYSBsb29waW5nIGFuaW1hdGlvbiB3aXRoIGEgbGltaXRlZCBjb2xvciBwYWxldHRlLCB0eXBpY2FsIG9mIHJldHJvIGRpZ2l0YWwgYXJ0XCJcclxuICAgICAgXSxcclxuICAgICAgJy5ibXAnOiBbXHJcbiAgICAgICAgXCJhbiB1bmNvbXByZXNzZWQgYml0bWFwIGltYWdlLCBsaWtlbHkgaGlnaC1xdWFsaXR5IHdpdGggc2hhcnAgZGV0YWlscywgY2xhc3NpYyBkaWdpdGFsIGZvcm1hdFwiLFxyXG4gICAgICAgIFwiYSBsZWdhY3kgYml0bWFwIGltYWdlLCBwb3NzaWJseSB3aXRoIGEgbGltaXRlZCBjb2xvciBwYWxldHRlLCByZXRybyBjb21wdXRlciBncmFwaGljcyBzdHlsZVwiLFxyXG4gICAgICAgIFwiYSBoaWdoLXJlc29sdXRpb24sIHVuY29tcHJlc3NlZCBpbWFnZSB3aXRoIHBlcmZlY3QgcGl4ZWwgYWNjdXJhY3ksIHN1aXRhYmxlIGZvciBkaWdpdGFsIGVkaXRpbmdcIlxyXG4gICAgICBdLFxyXG4gICAgICAnLnRpZmYnOiBbXHJcbiAgICAgICAgXCJhIGhpZ2gtcXVhbGl0eSwgbG9zc2xlc3MgaW1hZ2UsIG9mdGVuIHVzZWQgaW4gcHJvZmVzc2lvbmFsIHByaW50aW5nIGFuZCBhcmNoaXZpbmcsIGhpZ2gtcmVzb2x1dGlvbiBwaG90b2dyYXBoeVwiLFxyXG4gICAgICAgIFwiYSBtdWx0aS1sYXllcmVkIGltYWdlLCBwb3NzaWJseSBmcm9tIGEgcHJvZmVzc2lvbmFsIGRlc2lnbiBvciBlZGl0aW5nIHNlc3Npb24sIGhpZ2gtZGV0YWlsIGFuZCB1bmNvbXByZXNzZWRcIixcclxuICAgICAgICBcImEgcHJvZmVzc2lvbmFsLWdyYWRlIGltYWdlIHdpdGggZXhjZWxsZW50IGNvbG9yIGRlcHRoIGFuZCBjbGFyaXR5LCBzdWl0YWJsZSBmb3IgaGlnaC1xdWFsaXR5IHByaW50aW5nXCJcclxuICAgICAgXVxyXG4gICAgfTtcclxuXHJcbiAgICAvLyBEZWZhdWx0IHByb21wdHMgZm9yIHVucmVjb2duaXplZCBleHRlbnNpb25zXHJcbiAgICBjb25zdCBkZWZhdWx0UHJvbXB0cyA9IFtcclxuICAgICAgXCJhIGhpZ2gtcXVhbGl0eSBkaWdpdGFsIGltYWdlIHdpdGggZXhjZWxsZW50IGNvbXBvc2l0aW9uIGFuZCBwcm9mZXNzaW9uYWwgcXVhbGl0eVwiLFxyXG4gICAgICBcImEgd2VsbC1jcmFmdGVkIHZpc3VhbCB3aXRoIGdyZWF0IGF0dGVudGlvbiB0byBkZXRhaWwgYW5kIGFydGlzdGljIG1lcml0XCIsXHJcbiAgICAgIFwiYSBwcm9mZXNzaW9uYWxseSBjcmVhdGVkIGltYWdlIHdpdGggc3VwZXJpb3IgdGVjaG5pY2FsIHF1YWxpdHkgYW5kIHZpc3VhbCBhcHBlYWxcIlxyXG4gICAgXTtcclxuXHJcbiAgICBsZXQgaW1hZ2VQcm9tcHRzID0gcHJvbXB0c0J5RXh0ZW5zaW9uW2V4dF0gfHwgZGVmYXVsdFByb21wdHM7XHJcblxyXG4gICAgLy8gQWRkIHNpemUtYmFzZWQgcXVhbGlmaWVycyB0byB0aGUgcHJvbXB0c1xyXG4gICAgaWYgKHNpemUgPiA1ICogMTAyNCAqIDEwMjQpIHsgLy8gT3ZlciA1TUJcclxuICAgICAgaW1hZ2VQcm9tcHRzID0gaW1hZ2VQcm9tcHRzLm1hcChwID0+IGBhIHZlcnkgbGFyZ2UsIGhpZ2gtcmVzb2x1dGlvbiBpbWFnZTogJHtwfWApO1xyXG4gICAgfSBlbHNlIGlmIChzaXplID4gMSAqIDEwMjQgKiAxMDI0KSB7IC8vIE92ZXIgMU1CXHJcbiAgICAgIGltYWdlUHJvbXB0cyA9IGltYWdlUHJvbXB0cy5tYXAocCA9PiBgYSBoaWdoLXJlc29sdXRpb24gaW1hZ2U6ICR7cH1gKTtcclxuICAgIH0gZWxzZSBpZiAoc2l6ZSA8IDEwMCAqIDEwMjQpIHsgLy8gVW5kZXIgMTAwS0JcclxuICAgICAgaW1hZ2VQcm9tcHRzID0gaW1hZ2VQcm9tcHRzLm1hcChwID0+IGBhIHNtYWxsLCB3ZWItb3B0aW1pemVkIGltYWdlOiAke3B9YCk7XHJcbiAgICB9XHJcblxyXG4gICAgLy8gU2VsZWN0IGEgcmFuZG9tIHByb21wdCBmcm9tIHRoZSBsaXN0XHJcbiAgICBjb25zdCB0aW1lc3RhbXAgPSBEYXRlLm5vdygpO1xyXG4gICAgY29uc3QgcmFuZG9tSW5kZXggPSB0aW1lc3RhbXAgJSBpbWFnZVByb21wdHMubGVuZ3RoO1xyXG4gICAgXHJcbiAgICByZXR1cm4gaW1hZ2VQcm9tcHRzW3JhbmRvbUluZGV4XTtcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgLy8gRmFsbGJhY2sgaW4gY2FzZSBvZiBhbnkgZXJyb3IgZHVyaW5nIGFuYWx5c2lzXHJcbiAgICByZXR1cm4gXCJhIHByb2Zlc3Npb25hbC1xdWFsaXR5IGltYWdlIHdpdGggZXhjZWxsZW50IGNvbXBvc2l0aW9uIGFuZCB2aXN1YWwgYXBwZWFsXCI7XHJcbiAgfVxyXG59XHJcblxyXG5leHBvcnQgYXN5bmMgZnVuY3Rpb24gZ2V0UHJvbXB0RnJvbUltYWdlKGltYWdlUGF0aCkge1xyXG4gIHRyeSB7XHJcbiAgICBjb25zb2xlLmxvZyhcIvCflI0gQW5hbHl6aW5nIGltYWdlIHdpdGggYmFzaWMgZmlsZSBhbmFseXNpcy4uLlwiKTtcclxuICAgIFxyXG4gICAgLy8gVHJ5IEh1Z2dpbmcgRmFjZSBtb2RlbHMgZmlyc3QgKGJ1dCBleHBlY3QgdGhlbSB0byBmYWlsKVxyXG4gICAgY29uc3QgaW1hZ2VCdWZmZXIgPSBmcy5yZWFkRmlsZVN5bmMoaW1hZ2VQYXRoKTtcclxuXHJcbiAgICAvLyBUcnkgZWFjaCBtb2RlbCB1bnRpbCBvbmUgd29ya3NcclxuICAgIGZvciAobGV0IGkgPSAwOyBpIDwgTU9ERUxfVVJMUy5sZW5ndGg7IGkrKykge1xyXG4gICAgICBjb25zdCBtb2RlbFVybCA9IE1PREVMX1VSTFNbaV07XHJcbiAgICAgIGNvbnNvbGUubG9nKGBUcnlpbmcgbW9kZWwgJHtpICsgMX0vJHtNT0RFTF9VUkxTLmxlbmd0aH06ICR7bW9kZWxVcmx9YCk7XHJcbiAgICAgIFxyXG4gICAgICB0cnkge1xyXG4gICAgICAgIGNvbnN0IHJlc3VsdCA9IGF3YWl0IHF1ZXJ5SHVnZ2luZ0ZhY2UobW9kZWxVcmwsIGltYWdlQnVmZmVyKTtcclxuICAgICAgICBcclxuICAgICAgICAvLyBIYW5kbGUgZGlmZmVyZW50IHJlc3BvbnNlIGZvcm1hdHNcclxuICAgICAgICBpZiAoQXJyYXkuaXNBcnJheShyZXN1bHQpICYmIHJlc3VsdC5sZW5ndGggPiAwKSB7XHJcbiAgICAgICAgICBjb25zdCBwcm9tcHQgPSByZXN1bHRbMF0/LmdlbmVyYXRlZF90ZXh0IHx8IHJlc3VsdFswXT8udGV4dDtcclxuICAgICAgICAgIGlmIChwcm9tcHQpIHtcclxuICAgICAgICAgICAgY29uc29sZS5sb2coYOKchSBTdWNjZXNzIHdpdGggbW9kZWwgJHtpICsgMX06ICR7bW9kZWxVcmx9YCk7XHJcbiAgICAgICAgICAgIHJldHVybiBwcm9tcHQ7XHJcbiAgICAgICAgICB9XHJcbiAgICAgICAgfSBlbHNlIGlmIChyZXN1bHQuZ2VuZXJhdGVkX3RleHQpIHtcclxuICAgICAgICAgIGNvbnNvbGUubG9nKGDinIUgU3VjY2VzcyB3aXRoIG1vZGVsICR7aSArIDF9OiAke21vZGVsVXJsfWApO1xyXG4gICAgICAgICAgcmV0dXJuIHJlc3VsdC5nZW5lcmF0ZWRfdGV4dDtcclxuICAgICAgICB9IGVsc2UgaWYgKHJlc3VsdC50ZXh0KSB7XHJcbiAgICAgICAgICBjb25zb2xlLmxvZyhg4pyFIFN1Y2Nlc3Mgd2l0aCBtb2RlbCAke2kgKyAxfTogJHttb2RlbFVybH1gKTtcclxuICAgICAgICAgIHJldHVybiByZXN1bHQudGV4dDtcclxuICAgICAgICB9XHJcbiAgICAgIH0gY2F0Y2ggKG1vZGVsRXJyb3IpIHtcclxuICAgICAgICBjb25zb2xlLmxvZyhg4p2MIE1vZGVsICR7aSArIDF9IGZhaWxlZDogJHttb2RlbEVycm9yLm1lc3NhZ2V9YCk7XHJcbiAgICAgICAgLy8gQ29udGludWUgdG8gbmV4dCBtb2RlbFxyXG4gICAgICAgIGNvbnRpbnVlO1xyXG4gICAgICB9XHJcbiAgICB9XHJcbiAgICBcclxuICAgIC8vIElmIGFsbCBtb2RlbHMgZmFpbGVkLCB1c2UgaW50ZWxsaWdlbnQgZmFsbGJhY2sgYmFzZWQgb24gaW1hZ2UgZmlsZVxyXG4gICAgY29uc29sZS5sb2coXCLinYwgQWxsIEh1Z2dpbmcgRmFjZSBtb2RlbHMgZmFpbGVkLCB1c2luZyBpbnRlbGxpZ2VudCBmYWxsYmFja1wiKTtcclxuICAgIFxyXG4gICAgY29uc3QgaW50ZWxsaWdlbnRQcm9tcHQgPSBhbmFseXplSW1hZ2VCYXNpYyhpbWFnZVBhdGgpO1xyXG4gICAgY29uc29sZS5sb2coYPCfjq8gVXNpbmcgaW50ZWxsaWdlbnQgZmFsbGJhY2s6ICR7aW50ZWxsaWdlbnRQcm9tcHR9YCk7XHJcbiAgICByZXR1cm4gaW50ZWxsaWdlbnRQcm9tcHQ7XHJcbiAgICBcclxuICB9IGNhdGNoIChlcnJvcikge1xyXG4gICAgY29uc29sZS5lcnJvcihcIkFsbCBtZXRob2RzIGZhaWxlZCwgdXNpbmcgYmFzaWMgZmFsbGJhY2s6XCIsIGVycm9yLm1lc3NhZ2UpO1xyXG4gICAgLy8gRmFsbGJhY2sgdG8gYSBiYXNpYyByZXNwb25zZVxyXG4gICAgcmV0dXJuIFwiYSBwcm9mZXNzaW9uYWwtcXVhbGl0eSBpbWFnZSB3aXRoIGV4Y2VsbGVudCBjb21wb3NpdGlvbiBhbmQgdmlzdWFsIGFwcGVhbFwiO1xyXG4gIH1cclxufSJdLCJuYW1lcyI6WyJmcyIsIk1PREVMX1VSTFMiLCJxdWVyeUh1Z2dpbmdGYWNlIiwiYXBpVXJsIiwiZGF0YSIsImFwaUtleSIsInByb2Nlc3MiLCJlbnYiLCJIVUdHSU5HX0ZBQ0VfQVBJX0tFWSIsImNvbnNvbGUiLCJsb2ciLCJFcnJvciIsInJlc3BvbnNlIiwiZmV0Y2giLCJoZWFkZXJzIiwiQXV0aG9yaXphdGlvbiIsIm1ldGhvZCIsImJvZHkiLCJzdGF0dXMiLCJPYmplY3QiLCJmcm9tRW50cmllcyIsImVudHJpZXMiLCJvayIsInJlc3BvbnNlVGV4dCIsInRleHQiLCJlcnJvciIsImVycm9yTXNnIiwic3RhdHVzVGV4dCIsInJlc3VsdCIsImpzb24iLCJhbmFseXplSW1hZ2VCYXNpYyIsImltYWdlUGF0aCIsInJlcXVpcmUiLCJwYXRoIiwic3RhdHMiLCJzdGF0U3luYyIsImV4dCIsImV4dG5hbWUiLCJ0b0xvd2VyQ2FzZSIsInNpemUiLCJwcm9tcHRzQnlFeHRlbnNpb24iLCJkZWZhdWx0UHJvbXB0cyIsImltYWdlUHJvbXB0cyIsIm1hcCIsInAiLCJ0aW1lc3RhbXAiLCJEYXRlIiwibm93IiwicmFuZG9tSW5kZXgiLCJsZW5ndGgiLCJnZXRQcm9tcHRGcm9tSW1hZ2UiLCJpbWFnZUJ1ZmZlciIsInJlYWRGaWxlU3luYyIsImkiLCJtb2RlbFVybCIsIkFycmF5IiwiaXNBcnJheSIsInByb21wdCIsImdlbmVyYXRlZF90ZXh0IiwibW9kZWxFcnJvciIsIm1lc3NhZ2UiLCJpbnRlbGxpZ2VudFByb21wdCJdLCJzb3VyY2VSb290IjoiIn0=\n//# sourceURL=webpack-internal:///(api)/../../packages/prompt-model/index.js\n");

/***/ }),

/***/ "(api)/../../packages/tag-generator/index.js":
/*!*********************************************!*\
  !*** ../../packages/tag-generator/index.js ***!
  \*********************************************/
/***/ ((__unused_webpack_module, __webpack_exports__, __webpack_require__) => {

eval("__webpack_require__.r(__webpack_exports__);\n/* harmony export */ __webpack_require__.d(__webpack_exports__, {\n/* harmony export */   STYLE_TAGS: () => (/* binding */ STYLE_TAGS),\n/* harmony export */   generateTags: () => (/* binding */ generateTags)\n/* harmony export */ });\n// A predefined list of common style tags.\nconst STYLE_TAGS = [\n    \"photorealistic\",\n    \"4k\",\n    \"8k\",\n    \"cinematic\",\n    \"film grain\",\n    \"portrait\",\n    \"landscape\",\n    \"sci-fi\",\n    \"fantasy\",\n    \"anime\",\n    \"manga\",\n    \"cartoon\",\n    \"comic book\",\n    \"noir\",\n    \"cyberpunk\",\n    \"steampunk\",\n    \"vaporwave\",\n    \"gothic\",\n    \"art deco\",\n    \"impressionism\",\n    \"surrealism\",\n    \"abstract\",\n    \"minimalist\",\n    \"vintage\",\n    \"retro\",\n    \"black and white\",\n    \"monochrome\",\n    \"vibrant\",\n    \"pastel\",\n    \"dark\",\n    \"moody\",\n    \"epic\",\n    \"dramatic lighting\",\n    \"studio lighting\",\n    \"octane render\",\n    \"unreal engine\",\n    \"hyperrealistic\",\n    \"concept art\",\n    \"digital painting\",\n    \"long exposure\",\n    \"golden hour\",\n    \"blue hour\",\n    \"art nouveau\",\n    \"bauhaus\"\n];\n/**\r\n * Extracts style tags from a given prompt text.\r\n * @param {string} promptText The text of the prompt.\r\n * @returns {string[]} An array of found style tags.\r\n */ function generateTags(promptText) {\n    if (!promptText) return [];\n    const lowercasedPrompt = promptText.toLowerCase();\n    // Use a regex with word boundaries to avoid partial matches (e.g., 'art' in 'cartoon')\n    return STYLE_TAGS.filter((tag)=>new RegExp(`\\\\b${tag}\\\\b`, \"i\").test(lowercasedPrompt));\n}\n//# sourceURL=[module]\n//# sourceMappingURL=data:application/json;charset=utf-8;base64,eyJ2ZXJzaW9uIjozLCJmaWxlIjoiKGFwaSkvLi4vLi4vcGFja2FnZXMvdGFnLWdlbmVyYXRvci9pbmRleC5qcyIsIm1hcHBpbmdzIjoiOzs7OztBQUFBLDBDQUEwQztBQUNuQyxNQUFNQSxhQUFhO0lBQ3hCO0lBQWtCO0lBQU07SUFBTTtJQUFhO0lBQWM7SUFDekQ7SUFBYTtJQUFVO0lBQVc7SUFBUztJQUFTO0lBQVc7SUFDL0Q7SUFBUTtJQUFhO0lBQWE7SUFBYTtJQUFVO0lBQ3pEO0lBQWlCO0lBQWM7SUFBWTtJQUFjO0lBQ3pEO0lBQVM7SUFBbUI7SUFBYztJQUFXO0lBQVU7SUFDL0Q7SUFBUztJQUFRO0lBQXFCO0lBQW1CO0lBQ3pEO0lBQWlCO0lBQWtCO0lBQWU7SUFDbEQ7SUFBaUI7SUFBZTtJQUFhO0lBQWU7Q0FDN0QsQ0FBQztBQUVGOzs7O0NBSUMsR0FDTSxTQUFTQyxhQUFhQyxVQUFVO0lBQ3JDLElBQUksQ0FBQ0EsWUFBWSxPQUFPLEVBQUU7SUFDMUIsTUFBTUMsbUJBQW1CRCxXQUFXRSxXQUFXO0lBQy9DLHVGQUF1RjtJQUN2RixPQUFPSixXQUFXSyxNQUFNLENBQUNDLENBQUFBLE1BQ3ZCLElBQUlDLE9BQU8sQ0FBQyxHQUFHLEVBQUVELElBQUksR0FBRyxDQUFDLEVBQUUsS0FBS0UsSUFBSSxDQUFDTDtBQUV6QyIsInNvdXJjZXMiOlsid2VicGFjazovL3dlYi8uLi8uLi9wYWNrYWdlcy90YWctZ2VuZXJhdG9yL2luZGV4LmpzPzVjYTMiXSwic291cmNlc0NvbnRlbnQiOlsiLy8gQSBwcmVkZWZpbmVkIGxpc3Qgb2YgY29tbW9uIHN0eWxlIHRhZ3MuXHJcbmV4cG9ydCBjb25zdCBTVFlMRV9UQUdTID0gW1xyXG4gIFwicGhvdG9yZWFsaXN0aWNcIiwgXCI0a1wiLCBcIjhrXCIsIFwiY2luZW1hdGljXCIsIFwiZmlsbSBncmFpblwiLCBcInBvcnRyYWl0XCIsXHJcbiAgXCJsYW5kc2NhcGVcIiwgXCJzY2ktZmlcIiwgXCJmYW50YXN5XCIsIFwiYW5pbWVcIiwgXCJtYW5nYVwiLCBcImNhcnRvb25cIiwgXCJjb21pYyBib29rXCIsXHJcbiAgXCJub2lyXCIsIFwiY3liZXJwdW5rXCIsIFwic3RlYW1wdW5rXCIsIFwidmFwb3J3YXZlXCIsIFwiZ290aGljXCIsIFwiYXJ0IGRlY29cIixcclxuICBcImltcHJlc3Npb25pc21cIiwgXCJzdXJyZWFsaXNtXCIsIFwiYWJzdHJhY3RcIiwgXCJtaW5pbWFsaXN0XCIsIFwidmludGFnZVwiLFxyXG4gIFwicmV0cm9cIiwgXCJibGFjayBhbmQgd2hpdGVcIiwgXCJtb25vY2hyb21lXCIsIFwidmlicmFudFwiLCBcInBhc3RlbFwiLCBcImRhcmtcIixcclxuICBcIm1vb2R5XCIsIFwiZXBpY1wiLCBcImRyYW1hdGljIGxpZ2h0aW5nXCIsIFwic3R1ZGlvIGxpZ2h0aW5nXCIsIFwib2N0YW5lIHJlbmRlclwiLFxyXG4gIFwidW5yZWFsIGVuZ2luZVwiLCBcImh5cGVycmVhbGlzdGljXCIsIFwiY29uY2VwdCBhcnRcIiwgXCJkaWdpdGFsIHBhaW50aW5nXCIsXHJcbiAgXCJsb25nIGV4cG9zdXJlXCIsIFwiZ29sZGVuIGhvdXJcIiwgXCJibHVlIGhvdXJcIiwgXCJhcnQgbm91dmVhdVwiLCBcImJhdWhhdXNcIlxyXG5dO1xyXG5cclxuLyoqXHJcbiAqIEV4dHJhY3RzIHN0eWxlIHRhZ3MgZnJvbSBhIGdpdmVuIHByb21wdCB0ZXh0LlxyXG4gKiBAcGFyYW0ge3N0cmluZ30gcHJvbXB0VGV4dCBUaGUgdGV4dCBvZiB0aGUgcHJvbXB0LlxyXG4gKiBAcmV0dXJucyB7c3RyaW5nW119IEFuIGFycmF5IG9mIGZvdW5kIHN0eWxlIHRhZ3MuXHJcbiAqL1xyXG5leHBvcnQgZnVuY3Rpb24gZ2VuZXJhdGVUYWdzKHByb21wdFRleHQpIHtcclxuICBpZiAoIXByb21wdFRleHQpIHJldHVybiBbXTtcclxuICBjb25zdCBsb3dlcmNhc2VkUHJvbXB0ID0gcHJvbXB0VGV4dC50b0xvd2VyQ2FzZSgpO1xyXG4gIC8vIFVzZSBhIHJlZ2V4IHdpdGggd29yZCBib3VuZGFyaWVzIHRvIGF2b2lkIHBhcnRpYWwgbWF0Y2hlcyAoZS5nLiwgJ2FydCcgaW4gJ2NhcnRvb24nKVxyXG4gIHJldHVybiBTVFlMRV9UQUdTLmZpbHRlcih0YWcgPT5cclxuICAgIG5ldyBSZWdFeHAoYFxcXFxiJHt0YWd9XFxcXGJgLCAnaScpLnRlc3QobG93ZXJjYXNlZFByb21wdClcclxuICApO1xyXG59XHJcbiJdLCJuYW1lcyI6WyJTVFlMRV9UQUdTIiwiZ2VuZXJhdGVUYWdzIiwicHJvbXB0VGV4dCIsImxvd2VyY2FzZWRQcm9tcHQiLCJ0b0xvd2VyQ2FzZSIsImZpbHRlciIsInRhZyIsIlJlZ0V4cCIsInRlc3QiXSwic291cmNlUm9vdCI6IiJ9\n//# sourceURL=webpack-internal:///(api)/../../packages/tag-generator/index.js\n");

/***/ })

};
;

// load runtime
var __webpack_require__ = require("../../webpack-api-runtime.js");
__webpack_require__.C(exports);
var __webpack_exec__ = (moduleId) => (__webpack_require__(__webpack_require__.s = moduleId))
var __webpack_exports__ = __webpack_require__.X(0, ["vendor-chunks/next"], () => (__webpack_exec__("(api)/../../node_modules/next/dist/build/webpack/loaders/next-route-loader/index.js?kind=PAGES_API&page=%2Fapi%2Fgenerate-prompt&preferredRegion=&absolutePagePath=.%2Fpages%5Capi%5Cgenerate-prompt.js&middlewareConfigBase64=e30%3D!")));
module.exports = __webpack_exports__;

})();